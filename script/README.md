## Scripts
This folder contains all custom scripts created to complete this project, including a general usage description. 

# Shortlist_script.sh
This is the first step in the pipeline. The original gff3 file contains features for the entire genome.
Shortlist_script.sh filters the genes of interest out of the large gff3 file.
The script needs two input files and delivers a single gff3 output file.
- Input:
1. gff3 file (whole genome)
2. A list with names of genes that are interesting.
- Output:
1. gff3 shortlist in txt format (gff3_shortlist.txt)

# slice_script.py
This script can run in either of two modes. Mode 1 slices all positions from a given GFF3-file and it's related fasta genome file. 
- input mode 1:
1. genome of species 1 in fasta format.
2. gff3 file related to genome given at input 1.
3. Newline saperated list containing only gene IDs of interest. 
- output mode 1:
One fasta file for every feature in the gff3 record at 1, containing the sequence for that feature for the reference species. The filenames follow the following naming convention:
- geneId:feature_type.fa
Running this script in it's second modus requires a file containing BLAST results. These BLAST results and knowledge of the query sequence is used which result is most likely its counterpart on the secondary parents genome. A fasta file with the secondary parents genome is also required.
- input mode 2:
1. One text file containing BLAST results in the following format:
filename_of_query_fasta \t contig_of_query_sequence \t query_start \t query_stop \n
2. genome of species 2 in fasta format. 
- output mode 2:
Updates on all fasta files in directory "fasta_resultaten", appending every sequence of the second parent to the fasta file of the first parent. 

# blast.sh
This script all sequences in the folder "fasta_resultaten" against a pre-specified target genome and reports all findings to the directory "blast_resultaten". 
input: 
1. A directory "fasta_resultaten" in the directory where blast.sh runs, with at least 1 fasta file with a single sequence. 
2. A fasta file for the target genome in the same directory where blast.sh runs. 
output:
1. Tabular (version 7) BLAST results, one file for each sequence in "fasta_resultaten", stored in the directory "blast_resultaten".

# blast_selector.py
This script filters every BLAST result in the directory "blast_resultaten" for the one record that most likely reflects the same sequence of the query. As of right now, this selection method is rather rudementary, choosing the hit with the highest bit score that is located on the exact same chromosome as the query. 
- input: 
1. A directory "blast_resultaten" with all BLAST results to be filtered in the same directory as this script is located in. 
- output:
1. A single file "target_gene_locations.txt", sharing the same directory as this script. It is formated as follows:
- filename_of_query_sequence \t contig_of_target_sequence \t start_position_target_sequence \t stop_postion_target_sequence \n

# translator.py
This script is able to translate nucleotide sequences into their respective amino acid sequences.
Input files have to be in FASTA format to be processed.
- Input:
1. Any number of FASTA files containing nucleotide sequences.
- Output:
1. The FASTA files with translated AA sequences.

# alignments.sh
This script aligns all fasta files generated by the slice script, using the programm MUSCLE-clwout algorithm.
- Input:
1. Any number of fasta files in a separate directory.
- Output:
1. One aligned output file for every input file (in clustalW format), outputted to a different seperate directory. 

# Variant_caller.py
Variant_caller.py processes MUSCLE-clwout alignment files. \n
After executing the script creates summary files containing summarys of the alignment results.
Every individual gene has it own summary file that contains multiple alignment results.
- Input:
1. Any number of alignment files in clustalW format.
- Output, content summary file:
1. Every aligned feature associated with the specific gene name.
2. With every feature the alignment length, identical nucleotides and indel frequency are saved.

# Total_variance.sh
Total_variance.sh appends to the summary files created by variant_caller.py. \n
It adds on 3 seperate lines. 
1. The first line represent the total alignment length, total identical nucleotides and total indels.
2. The second line finds it origin in the snpEff file. The specific gene that is being summarized is located in the snpEff file. \n
This line contains the snpEff exon variance and exon indel observations.
3. The final line contains the snpEff gene variance and gene indel observations.
- Input:
1. snpEff.tsv file

# TSV_creator.py
TSV_creatpr.py creates a count table that resembles the snpEff format. \n
In order to do this the script needs summary gene files that were finished after running the Total_variance.sh script. \n
- input:
1. Any number of summary files containg summarized alignment results (Alignment length, identical nucleotides and indel frequency.)
- output:
1. Count table that combines all the summary files into 5 columns. Feature name, indel count, variance count, snpEff indel count, snpeff feature count.





